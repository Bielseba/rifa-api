<% layout('layout') -%>
<div class="panel">
  <div class="panel-row">
    <div>
      <h3><%= campaign.title %></h3>
      <div class="muted">ID: <%= campaign.id %> • Preço: R$ <%= Number(campaign.ticket_price).toFixed(2) %> •
        Total: <%= campaign.total_tickets %> • Sorteio: <%= campaign.draw_date ? new Date(campaign.draw_date).toLocaleString() : '-' %>
      </div>
    </div>
    <div>
      <form method="post" action="/admin-ui/campaigns/<%= campaign.id %>/reserve" class="inline-form">
        <input name="ticket_number" placeholder="Número ex. 012" required />
        <input name="minutes" type="number" min="1" value="60" />
        <button class="btn" type="submit">Reservar</button>
      </form>
      <form method="post" action="/admin-ui/campaigns/<%= campaign.id %>/release" class="inline-form">
        <input name="ticket_number" placeholder="Número ex. 012" required />
        <button class="btn light" type="submit">Liberar</button>
      </form>
      <form method="post" action="/admin-ui/campaigns/<%= campaign.id %>/sell" class="inline-form">
        <input name="ticket_number" placeholder="Número ex. 050" required />
        <input name="customer_name" placeholder="Cliente" />
        <input name="customer_phone" placeholder="Telefone" />
        <button class="btn success" type="submit">Vender</button>
      </form>
    </div>
  </div>

  <div class="grid-numbers">
    <% numbers.forEach(n => { %>
      <div class="num <%= n.status %>">
        <span><%= n.ticket_number %></span>
        <small><%= n.status %><% if(n.reserved_until){ %> até <%= new Date(n.reserved_until).toLocaleTimeString() %><% } %></small>
      </div>
    <% }) %>
  </div>
</div>
